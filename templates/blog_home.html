{% extends "base.html" %}

{% block content %}
<section class="section">
  <div class="container">
    <!-- Cabeçalho Centralizado -->
    <div class="has-text-centered">
      <!-- <h1 class="title is-2 is-family-serif">ONSS Blog</h1> -->
      <!-- <p class="subtitle is-5">Descubra os textos e reflexões</p> -->
    </div>
    
    <!-- Filtro de Tags com largura reduzida -->
    <div class="field" style="max-width: 300px; margin: 2rem auto;">
      <label class="label">Filtrar por:</label>
      <div class="control">
        <div class="select">
          <select onchange="location = this.value;">
            <option value="{{ url_for('blog', lang=lang) }}">Todas</option>
            {% set all_tags = metainfos | map(attribute="tags") | sum(start=[]) | unique | sort %}
            {% for tag in all_tags %}
              <option value="{{ url_for('blog', lang=lang) }}?tag={{ tag }}" {% if tag == selected_tag %}selected{% endif %}>
                {{ tag }}
              </option>
            {% endfor %}
          </select>
        </div>
      </div>
    </div>
    
    <!-- Lista de Posts -->
    {% if metainfos %}
      <div class="columns is-multiline" style="margin-top: 2rem;">
        {% for post in metainfos %}
          <div class="column is-12">
            <article class="box" style="border: none; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
              <a href="{{ url_for('post', path=post.file|safe, lang=lang) }}">
                <h2 class="title is-3 is-family-serif">{{ post.title[0]|safe }}</h2>
                <h3 class="subtitle is-5 has-text-grey">{{ post.subtitle[0]|safe }}</h3>
              </a>
    
              {% if post.tags %}
                <div class="tags mt-3" style="margin-bottom: 1rem;">
                  {% for tag in post.tags %}
                    <a href="{{ url_for('blog', lang=lang) }}?tag={{ tag }}" class="tag is-light">
                      #{{ tag }}
                    </a>
                  {% endfor %}
                </div>
              {% endif %}
    
              <a class="button is-warning is-light" href="{{ url_for('post', path=post.file|safe, lang=lang) }}">
                {% if lang == 'en' %}
                  Read Post
                {% else %}
                  Ler Post
                {% endif %}
              </a>
            </article>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="has-text-centered" style="margin-top: 2rem;">Nenhum post encontrado para esta tag.</p>
    {% endif %}
  </div>
</section>
{% endblock %}
